<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="mcp-tool-impl-getCapabilities-subflow" doc:id="587c2b4d-d03d-45e6-8355-7d6d4a942d6a" >
		<ee:transform doc:name="Response" doc:id="61fb1bc1-3779-4847-93be-17eafa164989" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json indent=false
---
{
  "jsonrpc": "2.0",
  "result": {
  	 "description": "description": "This capability manifest describes the tools (methods) exposed by this agent. Each tool includes a name, description, and an input schema that defines the parameters required to invoke it. Agents can use this manifest to dynamically plan their next actions without hardcoding tool knowledge. The tools listed here follow the JSON-RPC 2.0 specification and must be invoked via POST requests to the MCP endpoint. Agents should first inspect this manifest to determine which tools are available and how to use them, then construct a valid request matching the toolâ€™s input schema.",
	 "tools": [ 
	  	 {
	      "name": "getAvailableCollectors",
	      "description": "Returns all collector identifiers supported by the agent.",
	      "inputSchema": {
	        "type": "object",
	        "properties": {}
	      }
	     },
	     {
	      "name": "getPlatformMetricsByCollector",
	      "description": "Retrieves metrics from a specific Anypoint collector with optional filters",
	      "inputSchema": {
	        "type": "object",
	        "properties": {
	          "collectorId": { "type": "string" },
	          "bg": { "type": "string" },
	          "filters": {
	            "type": "object",
	            "properties": {
	              "environment": { "type": "string" },
	              "region": { "type": "string" }
	            }
	          }
	        },
	        "required": ["collectorId", "bg"]
	      }
	    },
	    {
	      "name": "getPlatformMetricByKey",
	      "description": "Fetches a single metric value by key and collector. Useful for atomic, low-latency reads.",
	      "inputSchema": {
	        "type": "object",
	        "properties": {
	          "collector": { "type": "string" },
	          "metricKey": { "type": "string" },
	          "bg": { "type": "string" },
	          "environment": { "type": "string" }
	        },
	        "required": ["collector", "metricKey", "bg"]
	      }
	    }
    ]
  },
  "id": payload.id
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
	<sub-flow name="mcp-tool-impl-getAvailableCollectors-subflow" doc:id="63fdfd27-b25c-4ca5-8b85-0a43af062510" >
		<ee:transform doc:name="Response" doc:id="4277d53f-471e-4a1a-973f-ef927cb2cb32" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json indent=false
---
{
  "jsonrpc": "2.0",
  "result": [
    "ap",
    "apc",
    "apm",
    "arm",
    "apma",
    "amq",
    "ch",
    "core",
    "dc",
    "ex",
    "osv2",
    "rtf"
  ],
  "id": "304063a5-5c6f-4c5f-a496-64a04e4639cf"
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
</mule>
